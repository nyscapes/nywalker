<h1>List of Places</h1>
<p class="lead">All the places that we have added to the database.</p>
<div class="row">
  <div class="col-sm-6">
    {{#logged_in}}
      <a href="/places/new" class="btn btn-primary btn-default" role="button">Add Place</a>
    {{/logged_in}}
    <table class="table table-hover">
      <thead>
        <tr>
          <th>&nbsp;</th>
          <th>&nbsp;</th>
          <th>&nbsp;</th>
          <th>Place</th>
          <th>Instances</th>
        </tr>
      </thead>
      <tbody>
        {{#places}}
          <tr>
            <td>
              <a href="#" onclick="recenterMap(L.latLng({{lat}}, {{lon}}));">
                <span class="fa fa-globe" aria-hidden="true"></span>
              </a>
            <td>
              {{#flagged}}
                <span class="fa fa-flag" aria-hidden="true"></span>
              {{/flagged}}
              {{^flagged}}
                &nbsp;
              {{/flagged}}
            </td>
            <td>
              {{#note}}
                <span class="fa fa-comment" aria-hidden="true"></span>
              {{/note}}
              {{^note}}
                &nbsp;
              {{/note}}
            </td>
            <td class="{{ confidence_class }}">
              <a href="/places/{{slug}}">
                {{name}}
              </a>
            </td>
            <td>
              {{instances}}
            </td>
          </tr>
        {{/places}}
      </tbody>
    </table>
  </div>
  <div class="col-sm-6 map" id="map">
  </div>
</div>
  <script>
    var confidence_array = [{}, 
      {'opacity': 0.25, 'fillColor': '#000099', 'color': '#000099'}, 
      {'opacity': 0.4, 'fillColor': '#0000aa', 'color': '#0000aa'},
      {'opacity': 0.7, 'fillColor': '#0000ee', 'color': '#0000ee'}
    ];
    var map = L.map('map').setView(washingtonSquare, 11 );
    var baseLayer = L.tileLayer.provider('OpenStreetMap.Mapnik').addTo(map);
    var dots = L.markerClusterGroup();
    {{#mappable_places}}
      dots.addLayer(L.circleMarker([{{lat}}, {{lon}}], confidence_array[{{confidence}}]).bindPopup("<h4><a href='/places/{{slug}}'>{{name}}</a></h4><small><strong>Referred to as:</strong><br/>{{{place_names}}}<strong>Total mentions:</strong> {{count}}<br/><strong>Confidence (0â€“3):</strong> {{confidence}}</small>").bindTooltip("{{name}}"));
    {{/mappable_places}}
    dots.addTo(map);
    map.fitBounds(dots.getBounds());
  </script>
